#include <stdio.h>
#include <string.h>
#include <stdio.h>

int gcd(int a, int b) {
    if (b == 0) return a;
    return gcd(b, a % b);
}

long long modexp(long long base, long long exp, long long mod) {
    long long result = 1;
    while (exp > 0) {
        if (exp % 2 == 1)
            result = (result * base) % mod;
        base = (base * base) % mod;
        exp /= 2;
    }
    return result;
}

int main() {
    int p, q, msg, i;
    long long n, z, e, d = 0;

    printf("Enter the number to be encrypted and decrypted:\n");
    scanf("%d", &msg);

    printf("Enter 1st prime number p:\n");
    scanf("%d", &p);

    printf("Enter 2nd prime number q:\n");
    scanf("%d", &q);

    n = (long long)p * q;
    z = (long long)(p - 1) * (q - 1);

    printf("The value of n = %lld\n", n);
    printf("The value of z = %lld\n", z);

    for (e = 2; e < z; e++) {
        if (gcd(e, z) == 1)
            break;
    }

    printf("The value of e = %lld\n", e);

    for (i = 1; i <= 10; i++) {
        long long x = 1 + i * z;
        if (x % e == 0) {
            d = x / e;
            break;
        }
    }

    printf("The value of d = %lld\n", d);

    long long cipher = modexp(msg, e, n);
    printf("\nEncrypted message = %lld\n", cipher);

    long long decrypted = modexp(cipher, d, n);
    printf("Decrypted message = %lld\n", decrypted);

    return 0;
}

int main() {
    char text[100];
    int key;
    
    printf("Enter a message: ");
    gets(text);  // simple input for this example
    
    printf("Enter the key (an integer): ");
    scanf("%d", &key);
    
    char encrypted[100], decrypted[100];
    strcpy(encrypted, text);
    strcpy(decrypted, text);
    
    // Encryption
    for (int i = 0; i < strlen(encrypted); i++) {
        char ch = encrypted[i];
        if (ch >= 'a' && ch <= 'z')
            ch = (ch - 'a' + key) % 26 + 'a';
        else if (ch >= 'A' && ch <= 'Z')
            ch = (ch - 'A' + key) % 26 + 'A';
        encrypted[i] = ch;
    }

    // Decryption
    for (int i = 0; i < strlen(decrypted); i++) {
        char ch = encrypted[i];
        if (ch >= 'a' && ch <= 'z')
            ch = (ch - 'a' - key + 26) % 26 + 'a';
        else if (ch >= 'A' && ch <= 'Z')
            ch = (ch - 'A' - key + 26) % 26 + 'A';
        decrypted[i] = ch;
    }

    printf("Encrypted message: %s\n", encrypted);
    printf("Decrypted message: %s\n", decrypted);
    
    return 0;
}
------------------------------------------------------------------------

2. TRANSPOSITION (RAIL FIENCE)
#include <stdio.h>
#include <string.h>

int main(){
    char text[100];
    int rails;
    printf("Enter plaintext (max 99 chars): ");
    fgets(text, sizeof(text), stdin);
    text[strcspn(text, "\n")] = 0;

    printf("Enter number of rails: ");
    scanf("%d", &rails);

    int len = strlen(text), i, j, dir = 0, r = 0;
    char rail[10][100];
    for(i=0;i<rails;i++) for(j=0;j<len;j++) rail[i][j]='\n';

    for(i=0;i<len;i++){
        rail[r][i] = text[i];
        if(r==0) dir = 1;
        else if(r==rails-1) dir = 0;
        r += dir ? 1 : -1;
    }

    printf("\nPlaintext: %s\n", text);
    printf("Rails: %d\n", rails);
    printf("Ciphertext: ");
    for(i=0;i<rails;i++)
        for(j=0;j<len;j++)
            if(rail[i][j] != '\n') printf("%c", rail[i][j]);
    printf("\n");
    return 0;
}
------------------------------------------------------------------------

ROW TRANSPOSITION CIPHER


#include <stdio.h>
#include <string.h>

int main(){
    char pt[100], key[100];
    printf("Enter plaintext (max 99 chars): ");
    fgets(pt, sizeof pt, stdin); pt[strcspn(pt,"\n")]=0;
    printf("Enter key (e.g., a number or word like 312 or KEY, max 99 chars): ");
    fgets(key, sizeof key, stdin); key[strcspn(key,"\n")]=0;

    int L=strlen(pt), c=strlen(key), r=(L + c - 1)/c;
    char mat[20][20];
    for(int i=0;i<r*c;i++) mat[i/c][i%c] = (i < L) ? pt[i] : 'X';

    /* build array of (keychar, index) and sort by keychar then index */
    char kch[100]; int idx[100];
    for(int i=0;i<c;i++){ kch[i]=key[i]; idx[i]=i; }
    for(int i=0;i<c-1;i++){
        int m=i;
        for(int j=i+1;j<c;j++)
            if(kch[j] < kch[m] || (kch[j]==kch[m] && idx[j] < idx[m])) m=j;
        if(m!=i){ char t=kch[i]; kch[i]=kch[m]; kch[m]=t; int u=idx[i]; idx[i]=idx[m]; idx[m]=u; }
    }

    printf("\nPlaintext: %s\n", pt);
    printf("Key: %s\n", key);
    printf("Ciphertext: ");
    for(int p=0;p<c;p++){
        int col = idx[p];
        for(int row=0; row<r; row++) putchar(mat[row][col]);
    }
    printf("\n");
    return 0;
}


------------------------------------------------------------------------
des
#include <stdio.h>
#include <string.h>

void encrypt_data(const char *input, char *output, const char *key) {
    size_t len = strlen(input);
    size_t key_len = strlen(key);

    for (size_t i = 0; i < len; i++) {
        output[i] = input[i] ^ key[i % key_len];
    }
    output[len] = '\0';
}

void decrypt_data(const char *input, char *output, const char *key) {
    size_t len = strlen(input);
    size_t key_len = strlen(key);

    for (size_t i = 0; i < len; i++) {
        output[i] = input[i] ^ key[i % key_len];
    }
    output[len] = '\0';
}

int main() {
    char plaintext[256], key[256];
    char ciphertext[256], decryptedtext[256];

    printf("Enter plaintext: ");
    fgets(plaintext, sizeof(plaintext), stdin);
    plaintext[strcspn(plaintext, "\n")] = 0;

    printf("Enter key: ");
    fgets(key, sizeof(key), stdin);
    key[strcspn(key, "\n")] = 0;

    encrypt_data(plaintext, ciphertext, key);

    printf("\nPlaintext: %s\n", plaintext);
    printf("Ciphertext (Hex): ");
    for (size_t i = 0; i < strlen(ciphertext); i++) {
        printf("%02X", (unsigned char)ciphertext[i]);
    }
    printf("\n");

    decrypt_data(ciphertext, decryptedtext, key);
    printf("Decrypted text: %s\n", decryptedtext);

    return 0;
}

