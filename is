#include <stdio.h>
#include <math.h>

int gcd(int a, int b) {
    if (b == 0) return a;
    return gcd(b, a % b);
}

int main() {
    int p, q, n, z, d = 0, e, i, msg;
    double c;
    long long decrypted, j;

    printf("Enter the number to be encrypted and decrypted\n");
    scanf("%d", &msg);

    printf("Enter 1st prime number p\n");
    scanf("%d", &p);

    printf("Enter 2nd prime number q\n");
    scanf("%d", &q);

    n = p * q;
    z = (p - 1) * (q - 1);

    printf("the value of z = %d\n", z);

    for (e = 2; e < z; e++) {
        if (gcd(e, z) == 1) break;
    }

    printf("the value of e = %d\n", e);

    for (i = 0; i <= 9; i++) {
        int x = 1 + (i * z);
        if (x % e == 0) {
            d = x / e;
            break;
        }
    }

    printf("the value of d = %d\n", d);

    c = fmod(pow(msg, e), n);
    printf("Encrypted message is :-\n");
    printf("%f\n", c);

    decrypted = 1;
    for (j = 0; j < d; j++)
        decrypted = (long long)((decrypted * (long long)c) % n);

    printf("Derypted message is :-\n");
    printf("%lld\n", decrypted);

    return 0;
}


Enter the number to be encrypted and decrypted
3
Enter 1st prime number p
1
Enter 2nd prime number q
5
the value of z = 0
the value of e = 2
the value of d = 0
Encrypted message is :-
4.000000
Derypted message is :-
1


---------------------------------------------------------------------------------------------------------------------------------

Caesar cipher

#include <stdio.h>
#include <string.h>

int main() {
    char text[100];
    int key;
    
    printf("Enter a message: ");
    gets(text);  // simple input for this example
    
    printf("Enter the key (an integer): ");
    scanf("%d", &key);
    
    char encrypted[100], decrypted[100];
    strcpy(encrypted, text);
    strcpy(decrypted, text);
    
    // Encryption
    for (int i = 0; i < strlen(encrypted); i++) {
        char ch = encrypted[i];
        if (ch >= 'a' && ch <= 'z')
            ch = (ch - 'a' + key) % 26 + 'a';
        else if (ch >= 'A' && ch <= 'Z')
            ch = (ch - 'A' + key) % 26 + 'A';
        encrypted[i] = ch;
    }

    // Decryption
    for (int i = 0; i < strlen(decrypted); i++) {
        char ch = encrypted[i];
        if (ch >= 'a' && ch <= 'z')
            ch = (ch - 'a' - key + 26) % 26 + 'a';
        else if (ch >= 'A' && ch <= 'Z')
            ch = (ch - 'A' - key + 26) % 26 + 'A';
        decrypted[i] = ch;
    }

    printf("Encrypted message: %s\n", encrypted);
    printf("Decrypted message: %s\n", decrypted);
    
    return 0;
}
------------------------------------------------------------------------

2. TRANSPOSITION (RAIL FIENCE)
#include <stdio.h>
#include <string.h>

int main(){
    char text[100];
    int rails;
    printf("Enter plaintext (max 99 chars): ");
    fgets(text, sizeof(text), stdin);
    text[strcspn(text, "\n")] = 0;

    printf("Enter number of rails: ");
    scanf("%d", &rails);

    int len = strlen(text), i, j, dir = 0, r = 0;
    char rail[10][100];
    for(i=0;i<rails;i++) for(j=0;j<len;j++) rail[i][j]='\n';

    for(i=0;i<len;i++){
        rail[r][i] = text[i];
        if(r==0) dir = 1;
        else if(r==rails-1) dir = 0;
        r += dir ? 1 : -1;
    }

    printf("\nPlaintext: %s\n", text);
    printf("Rails: %d\n", rails);
    printf("Ciphertext: ");
    for(i=0;i<rails;i++)
        for(j=0;j<len;j++)
            if(rail[i][j] != '\n') printf("%c", rail[i][j]);
    printf("\n");
    return 0;
}


------------------------------------------------------------------------
des
#include <stdio.h>
#include <string.h>

void encrypt_data(const char *input, char *output, const char *key) {
    size_t len = strlen(input);
    size_t key_len = strlen(key);

    for (size_t i = 0; i < len; i++) {
        output[i] = input[i] ^ key[i % key_len];
    }
    output[len] = '\0';
}

void decrypt_data(const char *input, char *output, const char *key) {
    size_t len = strlen(input);
    size_t key_len = strlen(key);

    for (size_t i = 0; i < len; i++) {
        output[i] = input[i] ^ key[i % key_len];
    }
    output[len] = '\0';
}

int main() {
    char plaintext[256], key[256];
    char ciphertext[256], decryptedtext[256];

    printf("Enter plaintext: ");
    fgets(plaintext, sizeof(plaintext), stdin);
    plaintext[strcspn(plaintext, "\n")] = 0;

    printf("Enter key: ");
    fgets(key, sizeof(key), stdin);
    key[strcspn(key, "\n")] = 0;

    encrypt_data(plaintext, ciphertext, key);

    printf("\nPlaintext: %s\n", plaintext);
    printf("Ciphertext (Hex): ");
    for (size_t i = 0; i < strlen(ciphertext); i++) {
        printf("%02X", (unsigned char)ciphertext[i]);
    }
    printf("\n");

    decrypt_data(ciphertext, decryptedtext, key);
    printf("Decrypted text: %s\n", decryptedtext);

    return 0;
}



--------------------------------------------------------------------------------------------------------

4. DIFFIE HELLMAN
#include <stdio.h>
long long pwr(long long b, long long e, long long m) {
 long long r = 1;
 b %= m;
 while (e > 0) {
 if (e & 1) r = (r * b) % m;

b = (b * b) % m;
 e >>= 1;
 }
 return r;
}
int main() {
 long long P = 23;
 long long G = 5;
 long long a = 6;
 long long b = 15;
 long long A, B, K;
 A = pwr(G, a, P);
 B = pwr(G, b, P);
 K = pwr(B, a, P);
 printf("Public Parameters: P=%lld, G=%lld\n", P, G);
 printf("Alice Private Key a: %lld\n", a);
 printf("Bob Private Key b: %lld\n", b);
 printf("Alice Public Key A: %lld\n", A);
 printf("Bob Public Key B: %lld\n", B);
 printf("Shared Secret Key K: %lld\n", K);
return 0;
}
Public Parameters: P=23, G=5
Alice Private Key a:6
Bob Private Key b: 15
Alice Public Key A: 8
Bob Public Key B: 19
Shared Secret Key K: 2
